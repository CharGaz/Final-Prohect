/* autogenerated by Processing revision 1293 on 2025-01-16 */
import processing.core.*;
import processing.data.*;
import processing.event.*;
import processing.opengl.*;

import g4p_controls.*;

import java.util.HashMap;
import java.util.ArrayList;
import java.io.File;
import java.io.BufferedReader;
import java.io.PrintWriter;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.IOException;

public class Processing extends PApplet {

//Librairies:


//Global Variables:
ArrayList<Star> stars = new ArrayList<Star>();
int numStars = 10000;
int[] starColor = {color(255), color(255, 200, 150), color(255, 100, 100), color(100, 200, 255), color(255, 255, 100), color(255, 150, 50)};

//Spiral Galaxy:
float rad = 450; //Radius of the solar system/ max radius
float elip = 0.8f; //Making the solar system into a elips, not just a circle
float twist = 8/rad; //"Twist" of the solar system

float[] angle = new float[numStars];
float[] radius = new float[numStars]; //radius of a star


//Panning and Zooming:
float scale = 1;
float scalefactor = 0.1f;
float xPan = 500;
float yPan = 400;
int panfactor = 12;


//Planets/solar system thingys:
float a,b,c,d;
float t=0;
float initAngle[] =new float[1000];
float orbitDirection[] =new float[1000];
int m;

SecondApplet sa; 
String args[] = {"Star info"};

boolean showSolarSystem = false;
boolean animation = true;


String[] starData;
int startLine = 0; 
int endLine = 1;

public void setup(){           
    /* size commented out by preprocessor */;
    background(0);
    createGUI();

    spiralGalaxy(); //Type of galaxy being drawn
    setupPlanets();

    starData = loadStrings("Star Info.txt");

    

    
    sa = new SecondApplet();
    PApplet.runSketch(args, sa);

    pauseButton.setVisible(false);
    playButton.setVisible(false);
}

public void draw(){
  background(0);
  translate(width/2, height/2);  
  scale(scale);
  translate(-xPan, -yPan);
  

  

  for(Star s : stars){
    if(!showSolarSystem){
      s.drawStar();
      s.solarSystem = false;
    }

    else{
      s.solarSystem(500,400,(s.size*50),1);
      if(animation){
        t = (t+0.00005f) % 720; //keeping t in the range of 720 degrees
      }
    } 
    s.starInfo();

  }   
}


public void mousePressed(){
  //Undoing the translations/scale on the coorodiantes of the mouse
  float x = ((mouseX - width/2) / scale) + xPan;
  float y = ((mouseY - height/2) / scale) + yPan;
  

  for(Star s : stars){
    //Cheking if mouse is within a star
    if(x >= s.pos.x - s.size && x <= s.pos.x + s.size && y >= s.pos.y-s.size && y <= s.pos.y + s.size ){
      resetView();

      showSolarSystem = true;
      s.solarSystem = true;

      pauseButton.setVisible(true);
      playButton.setVisible(true);
    }
    
  }
}

public void resetView(){
  scale = 1;
  xPan = 500;
  yPan = 400;
}

public class SecondApplet extends PApplet{

  public void settings() {
    size(300, 300);
  }
  
  public void setup(){
    surface.setTitle("Solar system info");
    surface.setLocation(0,475);
  }
  public void draw() {
    background(255);
    fill(0);
    int x = 10;
    int y = 25;
    

    for(int i = startLine; i < endLine; i++){
      int fontSize = 15;
      textSize(fontSize);
      
      while(textWidth(starData[i]) > 300){
        fontSize-=0.5f;
        textSize(fontSize);
      }
      text(starData[i],x,y);
      y += 15;
    }

  }
}

public void spiralGalaxy(){
    float cx = width/2; //center x
    float cy = height/2; //center y

    for(int i = 0; i < numStars; i++){

        angle[i] = random(TWO_PI);
        radius[i] = random(1, rad);
        float r = radius[i];
        float a = angle[i];
        angle[i] = a;

        float x = r*cos(a);
        float y = r*elip*sin(a);
        float b = r*twist;
        float s = sin(b);
        float c = cos(b);
         
        float finalX = cx + s * x + c * y; //Plotting the x to be on a spiral
        float finalY = cy + c * x - s * y; //Plotting the y to be on a spiral


        
        float brightness = random(50,255); //brightness of the star
        int starCol = starColor[PApplet.parseInt(random(starColor.length))]; // colour of the star

        float size = random(1,2); //size of the star
        if(starCol == color(255, 100, 100)){
            size = random(1.75f,2); //If star is red, than it is a red gaint
        }

        int bodies = PApplet.parseInt(random(2,3));
            
        stars.add(new Star(finalX,finalY, size, brightness, starCol, bodies)); //Putting info into star class  
    }
}
public void setupPlanets(){
    for(int i=0;i<1000;i++){
        initAngle[i]=2.f*PI*random(1);
        orbitDirection[i]=(random(1)<0.5f) ?1:-1;
    } 
}
class Star{
    PVector pos;
    float size;
    float brightness;
    int col;
    int systemBody;
    boolean solarSystem;

    //CONSTRUCTOR:
    Star(float x, float y, float size, float brightness, int col, int body){
        this.pos = new PVector(x,y);
        this.size = size;
        this.brightness = brightness;
        this.col = col;
        this.systemBody = body;
        this.solarSystem = false;
        
    }

    public void drawStar(){ //Drawing the star
  
        stroke(this.col);
        strokeWeight(this.size);
        circle(this.pos.x, this.pos.y, this.size);
        
    } 

    

    public void solarSystem(float x, float y, float r, int n){
        if(solarSystem){
            if(n == 1){
                stroke(this.col);
                fill(this.col);
            }
            else if(n==2){
                stroke(255,0,0);
                fill(255,0,0);
            }
            else if(n == 3){
                strokeWeight(r/12);
                stroke(0,255,0);
                fill(0,255,0);
            }
            else{
                stroke(0,0,255);
                fill(0,0,255);
            }
            circle(x,y, r);
            if(n == 1){
                m = 0;
            }

            a=initAngle[m];
            c=orbitDirection[m++];  
            b=initAngle[m];
            d=orbitDirection[m++];

            if( r > 1){
                int z = 2;
                for(int i = 0; i < this.systemBody; i++){
                    solarSystem(x+z*r*cos((t*c*(pow(2,n-1))*2.f*PI/360)+a),y+z*r*sin((t*c*(pow(2,n-1))*2.f*PI/360)+a),r/12,n+1);
                    z += random(2,3);
                }
            }
        } 
    }

    public void starInfo(){ //Lots of if statments for this :(
        if(this.col == color(255, 100, 100) && this.size >= 1.5f){
            startLine = 2;
            endLine = 7;
        }

        if(!showSolarSystem){
            startLine = 0;
            endLine = 1;
        }
    }
}




/* =========================================================
 * ====                   WARNING                        ===
 * =========================================================
 * The code in this tab has been generated from the GUI form
 * designer and care should be taken when editing this file.
 * Only add/edit code inside the event handlers i.e. only
 * use lines between the matching comment tags. e.g.

 void myBtnEvents(GButton button) { //_CODE_:button1:12356:
     // It is safe to enter your event code here  
 } //_CODE_:button1:12356:
 
 * Do not rename this tab!
 * =========================================================
 */

synchronized public void win_draw1(PApplet appc, GWinData data) { //_CODE_:window1:915552:
  appc.background(230);
} //_CODE_:window1:915552:

public void zoom_Clicked(GButton source, GEvent event) { //_CODE_:zoom:736080:
  scale += scalefactor;

} //_CODE_:zoom:736080:

public void zoomOut_Clicked(GButton source, GEvent event) { //_CODE_:zoomOut:358050:
  if(1 < scale){
    scale -= scalefactor;
  }
  
} //_CODE_:zoomOut:358050:

public void panLeft_Clickled(GButton source, GEvent event) { //_CODE_:panLeft:876359:
  if( 500/scale < xPan){
    xPan -= panfactor;
  }
  
} //_CODE_:panLeft:876359:

public void panRight_Clicked(GButton source, GEvent event) { //_CODE_:panRight:905221:
  if( xPan < 500*scale){
    xPan += panfactor;
  }
} //_CODE_:panRight:905221:

public void panUp_Clicked(GButton source, GEvent event) { //_CODE_:panUp:619938:
  if( 400/scale < yPan){
    yPan -= panfactor;
  }
} //_CODE_:panUp:619938:

public void panDown_Clicked(GButton source, GEvent event) { //_CODE_:panDown:224973:
  if( yPan < 400*scale){
    yPan += panfactor;
  }
} //_CODE_:panDown:224973:

public void scaleFactor_Change(GSlider source, GEvent event) { //_CODE_:scaleFactor:398326:
  scalefactor = scaleFactor.getValueF();
} //_CODE_:scaleFactor:398326:

public void panFactor_Change(GSlider source, GEvent event) { //_CODE_:panFactor:327259:
  panfactor = panFactor.getValueI();
} //_CODE_:panFactor:327259:

public void resetClicked(GButton source, GEvent event) { //_CODE_:resetButton:256849:
  resetView();
} //_CODE_:resetButton:256849:

public void galaxyResetClicked(GButton source, GEvent event) { //_CODE_:galaxyReset:601214:
  showSolarSystem = false;

  pauseButton.setVisible(false);
  playButton.setVisible(false);

  animation = true;
  
} //_CODE_:galaxyReset:601214:

public void pauseButtonClicked(GButton source, GEvent event) { //_CODE_:pauseButton:316338:
  animation = false;
} //_CODE_:pauseButton:316338:


public void playButtonClicked(GButton source, GEvent event) { //_CODE_:playButton:622061:
  animation = true;
} //_CODE_:playButton:622061:



// Create all the GUI controls. 
// autogenerated do not edit
public void createGUI(){
  G4P.messagesEnabled(false);
  G4P.setGlobalColorScheme(GCScheme.BLUE_SCHEME);
  G4P.setMouseOverEnabled(false);
  surface.setTitle("Sketch Window");
  window1 = GWindow.getWindow(this, "Sliders and Such", 0, 0, 300, 300, JAVA2D);
  window1.noLoop();
  window1.setActionOnClose(G4P.KEEP_OPEN);
  window1.addDrawHandler(this, "win_draw1");
  zoom = new GButton(window1, 11, 15, 80, 30);
  zoom.setText("Zoom in");
  zoom.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  zoom.addEventHandler(this, "zoom_Clicked");
  zoomOut = new GButton(window1, 12, 55, 80, 30);
  zoomOut.setText("Zoom out");
  zoomOut.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  zoomOut.addEventHandler(this, "zoomOut_Clicked");
  panLeft = new GButton(window1, 110, 55, 42, 30);
  panLeft.setTextAlign(GAlign.CENTER, GAlign.CENTER);
  panLeft.setText("←");
  panLeft.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  panLeft.addEventHandler(this, "panLeft_Clickled");
  panRight = new GButton(window1, 210, 55, 44, 30);
  panRight.setText("→");
  panRight.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  panRight.addEventHandler(this, "panRight_Clicked");
  panUp = new GButton(window1, 160, 15, 44, 30);
  panUp.setText("↑");
  panUp.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  panUp.addEventHandler(this, "panUp_Clicked");
  panDown = new GButton(window1, 160, 55, 44, 30);
  panDown.setText("↓");
  panDown.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  panDown.addEventHandler(this, "panDown_Clicked");
  scaleFactor = new GSlider(window1, 11, 95, 80, 40, 10.0f);
  scaleFactor.setShowValue(true);
  scaleFactor.setLimits(0.1f, 0.1f, 1.0f);
  scaleFactor.setNbrTicks(5);
  scaleFactor.setNumberFormat(G4P.DECIMAL, 2);
  scaleFactor.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  scaleFactor.setOpaque(false);
  scaleFactor.addEventHandler(this, "scaleFactor_Change");
  panFactor = new GSlider(window1, 134, 94, 100, 40, 10.0f);
  panFactor.setShowValue(true);
  panFactor.setLimits(10, 10, 20);
  panFactor.setNumberFormat(G4P.INTEGER, 0);
  panFactor.setLocalColorScheme(GCScheme.CYAN_SCHEME);
  panFactor.setOpaque(false);
  panFactor.addEventHandler(this, "panFactor_Change");
  resetButton = new GButton(window1, 11, 148, 80, 30);
  resetButton.setText("Reset View");
  resetButton.setLocalColorScheme(GCScheme.PURPLE_SCHEME);
  resetButton.addEventHandler(this, "resetClicked");
  galaxyReset = new GButton(window1, 134, 148, 80, 30);
  galaxyReset.setText("Back to Galaxy");
  galaxyReset.setLocalColorScheme(GCScheme.PURPLE_SCHEME);
  galaxyReset.addEventHandler(this, "galaxyResetClicked");
  pauseButton = new GButton(window1, 135, 189, 80, 30);
  pauseButton.setText("Pause");
  pauseButton.setLocalColorScheme(GCScheme.PURPLE_SCHEME);
  pauseButton.addEventHandler(this, "pauseButtonClicked");
  playButton = new GButton(window1, 10, 189, 80, 30);
  playButton.setText("Play");
  playButton.setLocalColorScheme(GCScheme.PURPLE_SCHEME);
  playButton.addEventHandler(this, "playButtonClicked");
  window1.loop();
}

// Variable declarations 
// autogenerated do not edit
GWindow window1;
GButton zoom; 
GButton zoomOut; 
GButton panLeft; 
GButton panRight; 
GButton panUp; 
GButton panDown; 
GSlider scaleFactor; 
GSlider panFactor; 
GButton resetButton; 
GButton galaxyReset; 
GButton pauseButton; 
GButton playButton; 


  public void settings() { size(1000, 800); }

  static public void main(String[] passedArgs) {
    String[] appletArgs = new String[] { "Processing" };
    if (passedArgs != null) {
      PApplet.main(concat(appletArgs, passedArgs));
    } else {
      PApplet.main(appletArgs);
    }
  }
}
